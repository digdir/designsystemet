import { Meta } from '@components';
import { MenuPageLayout } from '@layouts';
import { Figma } from 'mdx-embed';
import { Heading, Paragraph, Alert } from '@digdir/design-system-react';

<Meta
  title='Feilmeldinger i ulike komponenter'
  description='Slik forteller du brukeren at noe har gått galt eller mangler.'
/>

export default ({ children, menu }) => (
  <MenuPageLayout
    content={children}
    data={{
      title: 'Feilmeldinger i ulike komponenter',
      date: '7. desember 2023',
    }}
  />
);

Når det har oppstått et problem som gjør at brukeren ikke kommer videre, skal vi vise en feilmelding som beskriver problemet og forklarer hva brukerne må gjøre.

## Retningslinjer

- Plasser feilmeldingen i nærheten av feltet som er feil, og koble den til feltet med `aria-describedby`.
- Bruk rød farge, [forklarende tekst](#tekst-i-feilmeldinger) og `aria-invalid`.
- I noen tilfeller bør det også vises en [oppsummerende feilmelding](#oppsummerende-feilmelding) øverst eller nederst på siden.

## Detaljerte feilmeldinger, for eksempel for et felt i et skjema

Feilmeldinger som tilhører ett bestemt område på siden, skal vi plassere så nært feilen som mulig. Feltet skal vise at noe er feil, for eksempel med rød ramme. Teksten som viser hva som er feil og hva brukeren må gjøre, skal komme rett under ledeteksten og eventuelt hjelpeteksten for feltet.

### Når skal feilmeldinger presenteres for brukeren?

Det finnes flere tidspunkt du kan presentere en feilmelding:

- Mens bruker fyller ut
- Idet fokus forlater feltet
- Når bruker trykker neste side/send inn skjema.

Du må ta en vurdering på når de forskjellige feilmeldingene skal vises, men det tryggeste er å vise feilmeldingene når brukeren selv er klar til å gå videre.

Påkrevde felter burde ikke aktivere feilmelding før bruker prøver å gå til neste side eller sender inn skjema. Om de aktiveres når brukeren forlater feltet kan det bli et irritasjonsmoment.

Noen felt kan med fordel sjekkes idet brukeren forlater feltet, for eksempel epost, telefonnummer, eller andre formateringer som er enkle å finne feil i. Om du har feilmeldinger som skal vises når bruker forlater feltet er det viktig å sjekke om brukeren faktisk har skrevet noe i feltet før du viser feilmeldingen. Mange bruker tastatur til å navigere seg gjennom skjema og vil ikke nødvendigvis starte på toppen og jobbe seg nedover, det vil da være forstyrrende om det dukker opp feilmeldinger på felter man ikke har jobbet med enda.

## Oppsummerende feilmeldinger

En oppsummerende feilmelding vises på toppen eller bunnen av en side og oppsummerer alle feil på siden. Meldingen kan gjelde for en eller flere feil. Teksten i en oppsummerende feilmelding skal være lik det du ser i den detaljerte feilen (se eksempel).

Vi plasserer oppsummerende feilmeldinger øverst eller nederst på siden og gir informasjon til brukerne om hva de skal gjøre for å komme videre. Om den plasseres toppen eller bunnen avhenger av løsningen din. Det viktige er at oppsummeringen er synlig uten at brukeren må lete etter den.

Pass på at

- oppsummeringen viser alle feilmeldingene som gjelder for siden eller trinnet
- brukerne kan gå direkte til feilene de må rette og at fokuset blir flyttet dit
- lenkene i oppsummeringen stemmer med feilmeldingen de lenker til
- du skriver feilmeldingen slik at den er lett å forstå, at den gir mening for brukerne når de kun leser feilmeldingen i oppsummeringen
- hvis det er flere feil, så lenker du til den første feilen i rekken
- feilene forsvinner fra oppsummeringen etter hvert som brukerne fikser dem

## Andre eksempler på denne komponenten

Feilmeldinger brukes i mange komponenter og kontekster. Hvordan vi viser og utformer feilmeldingen kan variere litt fra kontekst til kontekst, se eksemplene under.

### Feilmeldinger med accordion (trekkspilliste)

[Eksempel]

### Feilmeldinger med date field (datofelt)

[Eksempel]

### Feilmeldinger med drop-down menu (nedtrekkesmeny)

[Eksempel]

### Feilmeldinger med date picker (datovelger)

[Eksempel]

### Feilmeldinger med input field (inndatafelt)

[Eksempel]

### Feilmeldinger med radio buttons (alternativknapper)

[Eksempel]

### Feilmeldinger med text field (tekstfelt)

[Eksempel]

### Feilmeldinger med checkboxes (avmerkingsbokser)

Her har brukeren trykket på “Neste” uten å ha svart på spørsmål som må fylles ut. Den røde boksen i bunnen vises bare hvis brukeren har trykket på “Neste”.

<Figma
  title='Boop'
  url='file/vpM9dqqQPHqU6ogfKp5tlr/Felles-komponenter?type=design&node-id=17866%3A57910&mode=design&t=3hD9xEYGKMGecg7Q-1'
/>

### Feilmeldinger når brukerne skal legge ved en fil (attach)

[Eksempel]

## Retningslinjer for når du skal bruke feilmeldinger

Bruk feilmeldinger til å hjelpe brukeren gjennom de stegene de skal gjennom i en tjeneste.

Ikke bruk feilmeldinger til å fortelle brukerne at det er noe de ikke har rett på, eller ikke tillatelse til å gjøre. Hvis du trenger å gi denne typen informasjon, er det best å vise den på en egen side, og gi dem opplysninger om hva de kan gjøre videre.

Ikke bruk feilmeldinger til å varsle brukeren om feil som ikke kan forbindes med noe med brukeren gjør, for eksempel systemfeil. Da bruker vi heller alert-komponenten.

### Tekst i feilmeldinger

Den viktigste jobben til teksten i en feilmelding er å hjelpe brukerne videre:

- Tenk på målgruppen og skriv vennlig, klart og tydelig. Unngå passivt eller teknisk språk. Meldingen skal være lett å forstå.
- Unngå humor i feilmeldinger. Når folk møter på et problem, vil de heller ha effektive forslag til hvordan de løser det, enn humoristiske «Oops!»
- Vær konkret. Mange feilmeldinger kan være for generelle og fortelle at «noe gikk galt».
- Noen ganger må vi beskrive hva feilen er før vi beskriver hva brukerne skal gjøre, men det viktigste er å vise løsningen på problemet.
- Tilpass feilmeldingene til ulike situasjoner. Jobben til teksten er å hjelpe brukeren videre.
- Hold feilmeldingen kort, da sparer du brukerne for tid.

Eksempel på forklarende feilmeldinger:<br/>

- “Postnummeret må ha 4 siffer”
- "Fødselsnummeret må ha 11 siffer"
- “Velg minst ett av leveringsalternativene”
- “Kryss av i ruten for å bekrefte at navnet er riktig, før du sender inn skjemaet”

## Kilder

- [GovUK / Help users to Recover from validation errors](https://design-system.service.gov.uk/patterns/validation/)
- [Designing Better Error Messages UX, Smashing Magazine/Vitaly Friedman](https://www.smashingmagazine.com/2022/08/error-messages-ux-design)
- [UU-tilsynet](https://www.uutilsynet.no/veiledning/skjema/38#formidle_feil_i_skjema)
- [NN Group - Error Messages Guidelines](https://www.nngroup.com/articles/error-message-guidelines/)
- [NN Group - How to Report Errors in Forms](https://www.nngroup.com/articles/errors-forms-design-guidelines/)
