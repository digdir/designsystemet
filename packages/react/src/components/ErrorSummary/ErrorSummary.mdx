import { Meta, Controls, Primary, ArgTypes, Canvas } from '@storybook/blocks';

import * as ErrorSummaryStories from './ErrorSummary.stories';

import { ErrorSummary } from './';

<Meta of={ErrorSummaryStories} />

# ErrorSummary

`ErrorSummary` er en oppsummering av feil. Det gir brukeren oversikt over feil eller
mangler som må rettes på en side eller trinn, for å komme videre.

<Primary />
<Controls />

## Slik bruker du `ErrorSummary`

`ErrorSummary.Root` er påkrevd for å får riktig aria attributter (`aria-labelledby`, `role='alert'`, osv.).
Alle `ErrorSummary.Item` må ha en `href` for å kunne navigere til riktig sted i skjemaet.

```tsx
import { ErrorSummary } from '@digdir/designsystemet-react';

<ErrorSummary.Root>
  <ErrorSummary.Heading>Heading</ErrorSummary.Heading>
  <ErrorSummary.List>
    <ErrorSummary.Item href='#'>Item</ErrorSummary.Item>
  </ErrorSummary.List>
</ErrorSummary.Root>
```

## Eksempler

### Bruk med tekstfelt

<Canvas of={ErrorSummaryStories.WithForm} />

### aria-role='alert'

`ErrorSummary` har `aria-role='alert'` som standard. Dette betyr at skjermlesere vil lese opp innholdet i `ErrorSummary` automatisk. 
Det er fortsatt viktig at `ErrorSummary` får fokus ved submit slik at brukeren får med seg at det er feil eller mangler i skjemaet.

<Canvas of={ErrorSummaryStories.ShowHide} />

## Retningslinjer

Brukes til å vise en feiloppsummering når det er feil i noe brukeren har tastet inn, også hvis det er kun én feil på siden.

Slik fungerer det
- flytt fokuset på tastaturet til `ErrorSummary`
- bruk overskriften “det er oppstått et problem”
- lag lenke til hvert av svarene som har valideringsfeil
- forsikre deg om at feilmeldingen i `ErrorSummary` er formulert likt som de som vises ved siden av innspillene med feil

Passer til å 
- oppsummere feil for å gi brukeren oversikt over alle feilene, før feilmeldingsskjemaet sendes inn
- gi brukerne muligheten til å hoppe direkte til feltene med feil i skjemaet

<br />

Passer ikke til å 
- vise lange, tekniske feilkoder til brukerne. 

<br />

### Plassering

`ErrorSummary` vises nærmest Neste/Send inn-knappen. Vi anbefaler å vise oppsummeringen i nærheten av Neste-knappen for 
at brukerne skal forstå sammenhengen mellom feilen og hvorfor de blir hindret i å gå videre
`ErrorSummary` skal inneholde alle feilmeldingene som er på siden, så brukere navigere direkte 
til feilene og manglene.

Du kan lese mer om [oppsummering av flere feilmeldinger på våre nettsider](https://designsystemet.no/monstre/feilmeldinger#oppsummering-av-flere-feilmeldinger).

Det skal være lenker fra `ErrorSummary` til der feilen er på siden. Når brukeren trykker på en av lenkene, 
skal fokus flyttes til der feilen er.

Lenketeksten i `ErrorSummary` må være identisk med feilen den lenker til.

### Synlighet

Oppsummeringen skal ikke være synlig uten at brukeren foretar seg noe. Den skal bli synlig først når brukeren har utført en handling om utløser feil.

- Hvis vi validerer fortløpende (feks. ved onBlur på hvert felt), venter vi med å vise ErrorSummary til brukeren prøver å sende inn skjemaet.
- Det er viktig at komponenten får fokus når den visest, slik at brukeren får med seg at det er feil eller mangler i skjemaet.
- Feilmeldingene i oppsummeringen skal være formulert lik feilmeldingen ved feltet.
- Feilmeldingene skal lenke direkte til feltet det gjelder.
- Hvis feilen gjelder flere felt, lenker vi til det første tilfellet av feilen.

## Tilgjengelighet

`ErrorSummary` har `aria-role='alert'` som standard. Dette betyr at skjermlesere vil lese opp innholdet i `ErrorSummary` automatisk når den vises.
Alle punkt i listen er lenker, og oppfører seg som en lenke.

<br />
<br />

### `ErrorSummary.Item`

<ArgTypes of={ErrorSummary.Item} />
